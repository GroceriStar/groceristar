/*
* bootstrap-table - v1.8.1 - 2015-08-24
* https://github.com/wenzhixin/bootstrap-table
* Copyright (c) 2015 zhixin wen
* Licensed MIT License
*/
!function(a){"use strict";var b=function(a){var b=arguments,c=!0,d=1;return a=a.replace(/%s/g,function(){var a=b[d++];return"undefined"==typeof a?(c=!1,""):a}),c?a:""},c=function(b,c){var d=-1;return a.each(b,function(a,b){return b.field===c?(d=a,!1):!0}),d},d=function(b,c,d,e){if("string"==typeof c){var f=c.split(".");f.length>1?(c=window,a.each(f,function(a,b){c=c[b]})):c=window[c]}return"object"==typeof c?c:"function"==typeof c?c.apply(b,d):e},e=function(b,c,d){if(f(b,c)){b.append(a("<option></option>").attr("value",c).text(a("<div />").html(d).text()));var e=b.find("option:gt(0)");e.sort(function(b,c){return b=a(b).text().toLowerCase(),c=a(c).text().toLowerCase(),a.isNumeric(b)&&a.isNumeric(c)&&(b=parseFloat(b),c=parseFloat(c)),b>c?1:c>b?-1:0}),b.find("option:gt(0)").remove(),b.append(e)}},f=function(a,b){for(var c=a.get(0).options,d=0;d<c.length;d++)if(c[d].value===b)return!1;return!0},g=function(a){a.$tableHeader.css("height","77px")},h=function(a){var b=a.$header;return a.options.height&&(b=a.$tableHeader),b},i=function(a){var b="select, input";return a.options.height&&(b="table select, table input"),b},j=function(b){var c=h(b),d=i(b);b.options.values=[],c.find(d).each(function(){b.options.values.push({field:a(this).parent().parent().parent().data("field"),value:a(this).val()})})},k=function(b){var c=null,d=[],e=h(b),f=i(b);b.options.values.length>0&&e.find(f).each(function(){c=a(this).parent().parent().parent().data("field"),d=a.grep(b.options.values,function(a){return a.field===c}),d.length>0&&a(this).val(d[0].value)})},l=function(c,d){var f,g,h=!1,i=0;a.each(c.columns,function(c,i){if(f="hidden",g=[],i.visible){if(i.filterControl)switch(g.push('<div style="margin: 0px 2px 2px 2px;" class="filterControl">'),i.filterControl&&i.searchable&&(h=!0,f="visible"),i.filterControl.toLowerCase()){case"input":g.push(b('<input type="text" class="form-control" style="width: 100%; visibility: %s">',f));break;case"select":g.push(b('<select class="%s form-control" style="width: 100%; visibility: %s"></select>',i.field,f));break;case"datepicker":g.push(b('<input type="text" class="date-filter-control %s form-control" style="width: 100%; visibility: %s">',i.field,f))}else g.push('<div style="height: 34px;"></div>');if(a.each(d.children().children(),function(b,c){return c=a(c),c.data("field")===i.field?(c.find(".fht-cell").append(g.join("")),!1):void 0}),void 0!==i.filterData&&"column"!==i.filterData.toLowerCase()){var j=i.filterData.substring(0,3),k=i.filterData.substring(4,i.filterData.length),l=a("."+i.field);switch(e(l,"",""),j){case"url":a.ajax({url:k,dataType:"json",success:function(b){a.each(b,function(a,b){e(l,a,b)})}});break;case"var":var m=window[k];for(var n in m)e(l,n,m[n])}}}}),h?(d.off("keyup","input").on("keyup","input",function(a){clearTimeout(i),i=setTimeout(function(){c.onColumnSearch(a)},c.options.searchTimeOut)}),d.off("change","select").on("change","select",function(a){clearTimeout(i),i=setTimeout(function(){c.onColumnSearch(a)},c.options.searchTimeOut)}),d.find(".date-filter-control").length>0&&a.each(c.columns,function(b,c){void 0!==c.filterControl&&"datepicker"===c.filterControl.toLowerCase()&&d.find(".date-filter-control."+c.field).datepicker(c.filterDatepickerOptions).on("changeDate",function(b){a(b.currentTarget).keyup()})})):d.find(".filterControl").hide()};a.extend(a.fn.bootstrapTable.defaults,{filterControl:!1,onColumnSearch:function(){return!1},filterShowClear:!1,values:[]}),a.extend(a.fn.bootstrapTable.COLUMN_DEFAULTS,{filterControl:void 0,filterData:void 0,filterDatepickerOptions:void 0}),a.extend(a.fn.bootstrapTable.Constructor.EVENTS,{"column-search.bs.table":"onColumnSearch"});var m=a.fn.bootstrapTable.Constructor,n=m.prototype.init,o=m.prototype.initToolbar,p=m.prototype.initHeader,q=m.prototype.initBody,r=m.prototype.initSearch;m.prototype.init=function(){if(this.options.filterControl){var a=this;this.options.values=[],this.$el.on("reset-view.bs.table",function(){a.options.height&&(a.$tableHeader.find("select").length>0||a.$tableHeader.find("input").length>0||l(a,a.$tableHeader))}).on("post-header.bs.table",function(){k(a)}).on("post-body.bs.table",function(){a.options.height&&g(a)}).on("column-switch.bs.table",function(){k(a)})}n.apply(this,Array.prototype.slice.apply(arguments))},m.prototype.initToolbar=function(){if(!this.showToolbar&&this.options.filterControl&&(this.showToolbar=this.options.filterControl),o.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl&&this.options.filterShowClear){var b=this.$toolbar.find(">.btn-group"),c=b.find("div.export");c.length||(c=a(['<button class="btn btn-default " type="button">','<i class="glyphicon glyphicon-trash icon-share"></i> ',"</button>","</ul>"].join("")).appendTo(b),c.off("click").on("click",a.proxy(this.clearFilterControl,this)))}},m.prototype.initHeader=function(){p.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl&&l(this,this.$header)},m.prototype.initBody=function(){q.apply(this,Array.prototype.slice.apply(arguments));for(var b=this,f=this.options.data,g=this.pageTo<this.options.data.length?this.options.data.length:this.pageTo,h=this.pageFrom-1;g>h;h++){var i=f[h];a.each(this.header.fields,function(f,g){var j=i[g],k=b.columns[c(b.columns,g)];if(j=d(b.header,b.header.formatters[f],[j,i,h],j),!(k.checkbox&&k.radio||void 0===k.filterControl||"select"!==k.filterControl.toLowerCase()||!k.searchable||void 0!==k.filterData&&"column"!==k.filterData.toLowerCase())){var l=a("."+k.field);void 0!==l&&l.length>0&&(0===l.get(0).options.length&&e(l,"",""),e(l,j,j))}})}},m.prototype.initSearch=function(){r.apply(this,Array.prototype.slice.apply(arguments));var b=this,c=a.isEmptyObject(this.filterColumnsPartial)?null:this.filterColumnsPartial;this.data=c?a.grep(this.data,function(e,f){for(var g in c){var h=c[g].toLowerCase(),i=e[g];if(i=d(b.header,b.header.formatters[a.inArray(g,b.header.fields)],[i,e,f],i),-1===a.inArray(g,b.header.fields)||"string"!=typeof i&&"number"!=typeof i||-1===(i+"").toLowerCase().indexOf(h))return!1}return!0}):this.data},m.prototype.onColumnSearch=function(b){j(this);var c=a.trim(a(b.currentTarget).val()),d=a(b.currentTarget).parent().parent().parent().data("field");a.isEmptyObject(this.filterColumnsPartial)&&(this.filterColumnsPartial={}),c?this.filterColumnsPartial[d]=c:delete this.filterColumnsPartial[d],this.options.pageNumber=1,this.onSearch(b),this.updatePagination(),this.trigger("column-search",d,c)},m.prototype.clearFilterControl=function(){if(this.options.filterControl&&this.options.filterShowClear){a.each(this.options.values,function(a,b){b.value=""}),k(this);var b=h(this).find(i(this)),c=0;b.length>0&&(this.filterColumnsPartial={},clearTimeout(c),c=setTimeout(function(){a(b[0]).trigger("INPUT"===b[0].tagName?"keyup":"change")},this.options.searchTimeOut))}}}(jQuery);