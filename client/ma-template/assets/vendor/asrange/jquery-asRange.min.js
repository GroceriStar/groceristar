/*! asRange - v0.2.4 - 2014-09-30
* https://github.com/amazingSurge/jquery-asRange
* Copyright (c) 2014 amazingSurge; Licensed GPL */
!function(a){function b(b,c,d){this.$element=b,this.uid=c,this.parent=d,this.options=a.extend(!0,{},this.parent.options),this.direction=this.options.direction,this.value=null,this.classes={active:this.parent.namespace+"-pointer_active"}}var c="asRange",d={namespace:c,skin:null,max:100,min:0,value:null,step:10,limit:!0,range:!1,direction:"h",keyboard:!0,replaceFirst:!1,tip:!0,scale:!0,format:function(a){return a}},e=function(a){return a.touches&&(a=a.touches[0]),a},f=a[c]=function(b,e){var f={};if(this.element=b,this.$element=a(b),this.$element.is("input")){var g=this.$element.val();"string"==typeof g&&(f.value=g.split(","));var h=this;a.each(["min","max","step"],function(a,b){var c=parseFloat(h.$element.attr(b));isNaN(c)||(f[b]=c)}),this.$element.css({display:"none"}),this.$wrap=a("<div></div>"),this.$element.after(this.$wrap)}else this.$wrap=this.$element;if(this.options=a.extend({},d,e,this.$element.data(),f),this.namespace=this.options.namespace,this.components=a.extend(!0,{},this.components),this.pluginName=c,this.options.range&&(this.options.replaceFirst=!1),this.value=this.options.value,null===this.value&&(this.value=this.options.min),this.options.range?a.isArray(this.value)?1===this.value.length&&(this.value[1]=this.value[0]):this.value=[this.value,this.value]:a.isArray(this.value)&&(this.value=this.value[0]),this.min=this.options.min,this.max=this.options.max,this.step=this.options.step,this.interval=this.max-this.min,this.initialized=!1,this.updating=!1,this.disabled=!1,this.direction="v"===this.options.direction?{axis:"pageY",position:"top"}:{axis:"pageX",position:"left"},this.$wrap.addClass(this.namespace),this.options.skin&&this.$wrap.addClass(this.namespace+"_"+this.options.skin),this.max<this.min||this.step>=this.interval)throw new Error("error options about max min step");this.init()};f.prototype={constructor:f,components:{},init:function(){this.$wrap.append('<div class="'+this.namespace+'-bar" />'),this.buildPointers(),this.components.selected.init(this),this.options.tip!==!1&&this.components.tip.init(this),this.options.scale!==!1&&this.components.scale.init(this),this.set(this.value),this.bindEvents(),this._trigger("ready"),this.initialized=!0},_trigger:function(a){var b=Array.prototype.slice.call(arguments,1),d=[this].concat(b);this.$element.trigger(c+"::"+a,d),a=a.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});var e="on"+a;"function"==typeof this.options[e]&&this.options[e].apply(this,b)},buildPointers:function(){this.pointer=[];var c=1;this.options.range&&(c=2);for(var d=1;c>=d;d++){var e=a('<div class="'+this.namespace+"-pointer "+this.namespace+"-pointer-"+d+'"></div>').appendTo(this.$wrap),f=new b(e,d,this);this.pointer.push(f)}this.p1=this.pointer[0],this.options.range&&(this.p2=this.pointer[1])},bindEvents:function(){var b=this;this.$wrap.on("touchstart.asRange mousedown.asRange",function(a){if(b.disabled!==!0){a=e(a);var c=a.which?3===a.which:2===a.button;if(c&&!Touch)return!1;var d=b.$wrap.offset(),f=a[b.direction.axis]-d[b.direction.position],g=b.getAdjacentPointer.call(b,f);return g.mousedown.call(g,a),!1}}),this.$element.is("input")&&this.$element.on(c+"::change",function(){var a=b.get();b.$element.val(a)}),a.each(this.pointer,function(a,d){d.$element.on(c+"::move",function(){return b.value=b.get(),!b.initialized||b.updating?!1:(b._trigger("change",b.value,b.options.name,c,b),!1)})})},getValueFromPosition:function(a){return a>0?this.min+a/this.getLength()*this.interval:0},getAdjacentPointer:function(a){var b=this.getValueFromPosition(a);if(this.options.range){var c=this.p1.value,d=this.p2.value,e=Math.abs(c-d);return d>=c?b>c+e/2?this.p2:this.p1:b>d+e/2?this.p1:this.p2}return this.p1},getLength:function(){return"v"===this.options.direction?this.$wrap.height():this.$wrap.width()},update:function(b){var c=this;this.updating=!0,a.each(["max","min","step","limit","value"],function(a,d){b[d]&&(c[d]=b[d])}),(b.max||b.min)&&this.setInterval(b.min,b.max),b.value||(this.value=b.min),a.each(this.components,function(a,b){"function"==typeof b.update&&b.update(c)}),this.set(this.value),this._trigger("update"),this.updating=!1},get:function(){var b=this,c=[];if(a.each(this.pointer,function(a,b){c[a]=b.get()}),b.options.range)return c;if(c[0]===b.options.min&&("string"==typeof b.options.replaceFirst&&(c[0]=b.options.replaceFirst),"object"==typeof b.options.replaceFirst))for(var d in b.options.replaceFirst)c[0]=d;return c[0]},set:function(b){if(this.options.range){if("number"==typeof b&&(b=[b]),!a.isArray(b))return;a.each(this.pointer,function(a,c){c.set(b[a])})}else this.p1.set(b);this.value=b},val:function(a){return a?(this.set(a),this):this.get()},setInterval:function(a,b){this.min=a,this.max=b,this.interval=b-a},enable:function(){return this.disabled=!1,this.$wrap.removeClass(this.namespace+"_disabled"),this},disable:function(){return this.disabled=!0,this.$wrap.addClass(this.namespace+"_disabled"),this},destroy:function(){a.each(this.pointer,function(a,b){b.destroy()}),this.$wrap.destroy()}},f.defaults=d,f.registerComponent=function(a,b){f.prototype.components[a]=b},b.prototype={constructor:b,mousedown:function(b){var d=this.parent.direction.axis,f=this.parent.direction.position,g=this.parent.$wrap.offset();this.$element.trigger(c+"::moveStart",this),this.data={},this.data.start=b[d],this.data.position=b[d]-g[f];var h=this.parent.getValueFromPosition(this.data.position);return this.set(h),a.each(this.parent.pointer,function(a,b){b.deactive()}),this.active(),this.mousemove=function(a){var b=e(a),c=this.parent.getValueFromPosition(this.data.position+(b[d]||this.data.start)-this.data.start);return this.set(c),a.preventDefault(),!1},this.mouseup=function(){return a(document).off(".asRange mousemove.asRange touchend.asRange mouseup.asRange"),this.$element.trigger(c+"::moveEnd",this),!1},a(document).on("touchmove.asRange mousemove.asRange",a.proxy(this.mousemove,this)).on("touchend.asRange mouseup.asRange",a.proxy(this.mouseup,this)),!1},active:function(){this.$element.addClass(this.classes.active)},deactive:function(){this.$element.removeClass(this.classes.active)},set:function(a){this.value!==a&&(this.parent.step&&(a=this.matchStep(a)),this.options.limit===!0?a=this.matchLimit(a):(a<=this.parent.min&&(a=this.parent.min),a>=this.parent.max&&(a=this.parent.max)),this.value=a,this.updatePosition(),this.$element.focus(),this.$element.trigger(c+"::move",this))},updatePosition:function(){var a={};a[this.parent.direction.position]=this.getPercent()+"%",this.$element.css(a)},getPercent:function(){return(this.value-this.parent.min)/this.parent.interval*100},get:function(){return this.value},matchStep:function(a){var b=this.parent.step,c=b.toString().split(".")[1];return a=Math.round(a/b)*b,c&&(a=a.toFixed(c.length)),parseFloat(a)},matchLimit:function(a){var b,c,d=this.parent.pointer;return b=1===this.uid?this.parent.min:d[this.uid-2].value,c=d[this.uid]&&null!==d[this.uid].value?d[this.uid].value:this.parent.max,b>=a&&(a=b),a>=c&&(a=c),a},destroy:function(){this.$element.off(".asRange"),this.$element.remove()}},a.fn.asRange=function(b){if("string"!=typeof b)return this.each(function(){a.data(this,c)||a.data(this,c,new f(this,b))});var d=b,e=Array.prototype.slice.call(arguments,1);if(/^\_/.test(d))return!1;if(!(/^(get)$/.test(d)||"val"===d&&1===e.length))return this.each(function(){var b=a.data(this,c);b&&"function"==typeof b[d]&&b[d].apply(b,e)});var g=this.first().data(c);return g&&"function"==typeof g[d]?g[d].apply(g,e):void 0}}(jQuery),function(a){a.asRange.registerComponent("scale",{defaults:{scale:{valuesNumber:3,gap:1,grid:5}},init:function(b){var c=a.extend({},this.defaults,b.options.scale),d=c.scale;d.values=[],d.values.push(b.min);for(var e=(b.max-b.min)/(d.valuesNumber-1),f=1;f<=d.valuesNumber-2;f++)d.values.push(e*f);d.values.push(b.max);var g={scale:b.namespace+"-scale",lines:b.namespace+"-scale-lines",grid:b.namespace+"-scale-grid",inlineGrid:b.namespace+"-scale-inlineGrid",values:b.namespace+"-scale-values"},h=d.values.length,i=((d.grid-1)*(d.gap+1)+d.gap)*(h-1)+h,j=100/(i-1),k=100/(h-1);this.$scale=a("<div></div>").addClass(g.scale),this.$lines=a("<ul></ul>").addClass(g.lines),this.$values=a("<ul></ul>").addClass(g.values);for(var l=0;i>l;l++){var m;m=a(0===l||l===i||l%((i-1)/(h-1))===0?'<li class="'+g.grid+'"></li>':l%d.grid===0?'<li class="'+g.inlineGrid+'"></li>':"<li></li>"),m.css({left:j*l+"%"}).appendTo(this.$lines)}for(var n=0;h>n;n++)a("<li><span>"+d.values[n]+"</span></li>").css({left:k*n+"%"}).appendTo(this.$values);this.$lines.add(this.$values).appendTo(this.$scale),this.$scale.appendTo(b.$wrap)},update:function(a){this.$scale.remove(),this.init(a)}})}(jQuery),function(a){a.asRange.registerComponent("selected",{defaults:{},init:function(b){var c=this;if(this.$arrow=a("<span></span>").appendTo(b.$wrap),this.$arrow.addClass(b.namespace+"-selected"),b.options.range===!1&&b.p1.$element.on(b.pluginName+"::move",function(a,b){c.$arrow.css({left:0,width:b.getPercent()+"%"})}),b.options.range===!0){var d=function(){var a,d=b.p2.getPercent()-b.p1.getPercent();d>=0?a=b.p1.getPercent():(d=-d,a=b.p2.getPercent()),c.$arrow.css({left:a+"%",width:d+"%"})};b.p1.$element.on(b.pluginName+"::move",d),b.p2.$element.on(b.pluginName+"::move",d)}}})}(jQuery),function(a){a.asRange.registerComponent("tip",{defaults:{active:"always"},init:function(b){var c=this,d=a.extend({},this.defaults,b.options.tip);this.opts=d,this.classes={tip:b.namespace+"-tip",show:b.namespace+"-tip-show"},a.each(b.pointer,function(d,e){var f=a("<span></span>").appendTo(b.pointer[d].$element);f.addClass(c.classes.tip),"onMove"===c.opts.active&&(f.css({display:"none"}),e.$element.on(b.pluginName+"::moveEnd",function(){return c.hide(f),!1}).on(b.pluginName+"::moveStart",function(){return c.show(f),!1})),e.$element.on(b.pluginName+"::move",function(){var a;if(a=b.options.range?b.get()[d]:b.get(),"function"==typeof b.options.format)if(b.options.replaceFirst&&"number"!=typeof a){if("string"==typeof b.options.replaceFirst&&(a=b.options.replaceFirst),"object"==typeof b.options.replaceFirst)for(var c in b.options.replaceFirst)a=b.options.replaceFirst[c]}else a=b.options.format(a);return f.text(a),!1})})},show:function(a){a.addClass(this.classes.show),a.css({display:"block"})},hide:function(a){a.removeClass(this.classes.show),a.css({display:"none"})}})}(jQuery),function(a,b,c){var d=c(b);d.on("asRange::ready",function(a,b){var e,f={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(a){var b=a.keyCode||a.which;return b in f.map&&"function"==typeof f.map[b]?(f.map[b](a),!1):void 0},attach:function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&(c=b.toUpperCase(),c in f.keys?f.map[f.keys[c]]=a[b]:f.map[c]=a[b]);f.bound||(f.bound=!0,d.bind("keydown",f.press))},detach:function(){f.bound=!1,f.map={},d.unbind("keydown",f.press)}};b.options.keyboard===!0&&c.each(b.pointer,function(a,c){e=b.options.step?b.options.step:1;var d=function(){var a=c.value;c.set(a-e)},g=function(){var a=c.value;c.set(a+e)};c.$element.attr("tabindex","0").on("focus",function(){return f.attach({left:d,right:g}),!1}).on("blur",function(){return f.detach(),!1})})})}(window,document,jQuery);